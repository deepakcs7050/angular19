<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div formArrayName="entries">
    @for (entry of entries().controls; track $index) {
      <div [formGroupName]="$index" class="entry-row">

        @for (field of fields(); track field.fieldName) {
          <label>{{ field.fieldName }}</label>

          <input 
            [type]="field.type" 
            [formControlName]="field.fieldName"
            [required]="field.required"
          />

          @if (entry.get(field.fieldName)?.invalid && entry.get(field.fieldName)?.touched) {
            <small class="error">{{ field.fieldName }} is required</small>
          }
        }

        <button type="button" (click)="removeEntry($index)">Remove</button>
      </div>
    }
  </div>

  <button type="button" (click)="addEntry()">Add More</button>
  <button type="submit">Submit</button>
</form>

<pre>{{ form.value | json }}</pre>
